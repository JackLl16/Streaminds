@model X.PagedList.IPagedList<Streaminds.Web.Models.Dto.ProductoStreamingDto>
@using Microsoft.AspNetCore.Identity
@{
 ViewData["Title"] = "Productos Streaming";
 var search = ViewData["Search"] as string;
 var isAuthenticated = User?.Identity?.IsAuthenticated == true;
}

<div class="container mt-4">
 <h1>Productos Streaming</h1>
 <div class="row mb-3">
 <div class="col-md-6">
 <form method="get" class="d-flex">
 <input type="text" name="search" value="@search" class="form-control me-2" placeholder="Buscar por nombre..." />
 <button class="btn btn-primary">Buscar</button>
 </form>
 </div>
 <div class="col-md-6 text-end">
 @if(isAuthenticated)
 {
 <a class="btn btn-success" asp-action="Create">Crear nuevo</a>
 }
 </div>
 </div>

 @if (!Model.Any())
 {
 <div class="alert alert-info">No hay productos disponibles.</div>
 }
 else
 {
 if(!isAuthenticated)
 {
 <div class="row">
 @foreach(var item in Model)
 {
 <div class="col-md-4 mb-4">
 <div class="card h-100">
 <div class="card-body d-flex flex-column">
 <h5 class="card-title">@item.Nombre</h5>
 <h6 class="card-subtitle mb-2 text-muted">@item.TipoProducto</h6>
 <p class="card-text">@item.Descripcion</p>
 <div class="mt-auto">
 <p class="fw-bold">@item.Precio.ToString("C")</p>
 <p class="text-muted small">Duración: @item.DuracionDias días • Calidad: @item.CalidadVideo</p>
 <a class="btn btn-primary w-100" asp-controller="Ordenes" asp-action="Create">Comprar</a>
 </div>
 </div>
 </div>
 </div>
 }
 </div>
 }
 else
 {
 <table class="table table-striped">
 <thead>
 <tr>
 <th>Id</th>
 <th>Nombre</th>
 <th>Tipo</th>
 <th>Precio</th>
 <th>Duración (d)</th>
 <th>Calidad</th>
 <th>Activo</th>
 <th></th>
 </tr>
 </thead>
 <tbody>
 @foreach (var item in Model)
 {
 <tr>
 <td>@item.Id</td>
 <td>@item.Nombre</td>
 <td>@item.TipoProducto</td>
 <td>@item.Precio.ToString("C")</td>
 <td>@item.DuracionDias</td>
 <td>@item.CalidadVideo</td>
 <td>@(item.Activo ? "Sí" : "No")</td>
 <td>
 <a class="btn btn-sm btn-primary" asp-action="Edit" asp-route-id="@item.Id">Editar</a>
 <a class="btn btn-sm btn-danger" asp-action="Delete" asp-route-id="@item.Id">Eliminar</a>
 </td>
 </tr>
 }
 </tbody>
 </table>
 }
 }

 <nav>
 <ul class="pagination justify-content-center">
 @if (Model.HasPreviousPage)
 {
 <li class="page-item">
 <a class="page-link" asp-action="Index" asp-route-page="@Model.PageNumber -1" asp-route-search="@search">Anterior</a>
 </li>
 }
 else
 {
 <li class="page-item disabled"><span class="page-link">Anterior</span></li>
 }

 @for (int i =1; i <= Model.PageCount; i++)
 {
 <li class="page-item @(i == Model.PageNumber ? "active" : "")">
 <a class="page-link" asp-action="Index" asp-route-page="@i" asp-route-search="@search">@i</a>
 </li>
 }

 @if (Model.HasNextPage)
 {
 <li class="page-item">
 <a class="page-link" asp-action="Index" asp-route-page="@Model.PageNumber +1" asp-route-search="@search">Siguiente</a>
 </li>
 }
 else
 {
 <li class="page-item disabled"><span class="page-link">Siguiente</span></li>
 }
 </ul>
 </nav>
</div>